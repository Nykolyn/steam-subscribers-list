(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{91:function(e,t,a){"use strict";a.r(t);var n=a(48),r=a(15),s=a(22),u=a(101),o=a(33),c=a(30),i=a(34),l=a(0),b=a.n(l),p=a(16),d=a(138),m=(a(137),a(31)),h=function(e){var t=e.text,a=e.onClick,n=e.type,r=e.loading;return b.a.createElement("button",{type:n,className:"jelly-button",onClick:a},r?b.a.createElement("p",{className:"super-slide"},"Loading..."):b.a.createElement("p",{className:"super-slide"},t))};h.defaultProps={onClick:null,loading:!1};var f=h,g=function(e){return e.subscribtions.subs},v=function(e){return e.subscribtions.loading.getSubs},w=function(e){return e.subscribtions.loading.addSub},O=function(){return d.b.error("\ud83e\udd2a Sub already exists",{position:"top-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},S=function(e){return d.b.success("\ud83e\udd1f Sub added! Total ammout:  ".concat(e),{position:"top-right",autoClose:4e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},C=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",userID:""},a.warn=function(){return d.b.warn("\ud83d\ude24\ud83d\ude24\ud83d\ude24 Fill the field!!!",{position:"top-left",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;return a.setState(Object(m.a)({},n,r))},a.handleFormSubmit=function(e){e.preventDefault();var t=a.state,n=t.name,r=t.userID;return""===n?a.warn():r.includes("/")?a.warn():(a.props.handleSubmit(a.state),a.setState({name:"",userID:""}))},a}return Object(i.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.userID,n=this.props,r=n.handleFilterSubs,s=n.query,u=n.showFavorites,o=n.onChangeText,c=n.loading;return b.a.createElement("form",{onSubmit:this.handleFormSubmit,className:"sub-form"},b.a.createElement("input",{type:"text",autoComplete:"off",value:t,name:"name",onChange:this.handleInputChange,className:"sub-form__input",placeholder:"Add sub here"}),b.a.createElement("input",{type:"text",autoComplete:"off",value:a,name:"userID",onChange:this.handleInputChange,className:"sub-form__input",placeholder:"User id (optional)"}),b.a.createElement(f,{text:"Add new sub",loading:c,type:"submit"}),b.a.createElement("input",{type:"text",autoComplete:"off",value:s,autoFocus:!0,placeholder:"filter sub here",name:"query",onChange:r,className:"sub-form__input"}),b.a.createElement(f,{text:o,type:"button",onClick:function(){return u()}}),b.a.createElement(d.a,{position:"top-right",autoClose:4e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnVisibilityChange:!0,draggable:!0,pauseOnHover:!0}))}}]),t}(l.Component),j=Object(p.b)(function(e){return{loading:w(e)}})(C),x=a(237),E=a(234),y=a(3),P=a.n(y),k=a(10),F=a(32),N=a(166),L=a.n(N),D=a(168),I=a(46),A=a(6),T=a(17),q=a.n(T),_="http://localhost:5678",H=function(e){return q.a.get("".concat(_,"/subscribers/").concat(e)).then(function(e){return e.data.subs})},B=function(e){return q.a.post("".concat(_,"/subscribers"),e).then(function(e){return e.data.addedSub})},M=function(e,t){return q.a.patch("".concat(_,"/subscribers/updateSub/").concat(e),t).then(function(e){return e.data.updatedSub})},Y=a(28);L.a.defaultFormat="DD.MM.YYYY HH:mm";var J=function(e){var t=e._id,a=e.name,n=e.date,r=e.favorite,s=e.updateFavSub,u=Object(l.useState)(!1),o=Object(F.a)(u,2),c=o[0],i=o[1],p=function(){var e=Object(k.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,s(t,{favorite:!r});case 3:setTimeout(Object(k.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i(!1);case 1:case"end":return e.stop()}},e)})),1e3);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),d=L()(n,L.a.defaultFormat).fromNow();return b.a.createElement(b.a.Fragment,null,b.a.createElement("div",null,b.a.createElement("h2",null,a),b.a.createElement("p",{className:"item-date"},"Added: ","".concat(d,", ").concat(n))),b.a.createElement("button",{className:"image-wrapper",type:"button",onClick:function(){return p()}},c?b.a.createElement(D.ClipLoader,{color:"#fff",loading:c}):b.a.createElement("img",{className:"item-image",src:r?"https://image.flaticon.com/icons/svg/148/148838.svg":"https://image.flaticon.com/icons/svg/149/149219.svg",alt:"fav"})))};J.defaultProps={favorite:!1};var U={updateFavSub:function(e,t){return function(){var a=Object(k.a)(P.a.mark(function a(n,r){var s,u;return P.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=Object(Y.e)(r())){a.next=3;break}return a.abrupt("return");case 3:return Object(I.a)(s),n(Object(A.i)()),a.prev=5,a.next=8,M(e,t);case 8:return u=a.sent,a.next=11,n(Object(A.j)(u));case 11:return a.abrupt("return",a.sent);case 14:a.prev=14,a.t0=a.catch(5),n(Object(A.h)(a.t0)),console.error("error while updating favorite sub: ".concat(a.t0));case 18:case"end":return a.stop()}},a,null,[[5,14]])}));return function(e,t){return a.apply(this,arguments)}}()}},V=Object(p.b)(null,U)(J),z=function(e){var t=e.subscribers;return b.a.createElement("ul",{className:"subs-list container"},b.a.createElement(x.a,{className:"subs-list container"},t.map(function(e){return b.a.createElement(E.a,{key:e._id,timeout:500,classNames:"bounce"},b.a.createElement("li",{className:"subs-list__item"},b.a.createElement(V,e)))})))},G=1,K=20,Q=a(226),R=a(193),W=a.n(R),X=a(194),Z=a.n(X),$=function(e){var t=e.maxPage,a=e.handleChangePage,n=e.currentPage;return b.a.createElement("div",{className:"pagination-wrapper"},b.a.createElement(Q.a,{className:"pagination-button",color:"primary",name:"prev",disabled:n===G,onClick:function(){return a("prev")}},b.a.createElement(W.a,{className:"pagination-button",disabled:n===G})),b.a.createElement("h1",null,"Page ",n," of ",t()),b.a.createElement(Q.a,{className:"pagination-button",name:"next",disabled:n===t(),onClick:function(){return a("next")}},b.a.createElement(Z.a,{className:"pagination-button",disabled:n===G})))},ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.filter(function(e){return e.name.toLowerCase().includes(t.toLowerCase())||e.userID===t})},te=function(e){function t(){var e,a;Object(s.a)(this,t);for(var u=arguments.length,i=new Array(u),l=0;l<u;l++)i[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={query:"",showFavorites:!1,onChangeText:"Show favourites",perPage:K,currentPage:G},a.handleChangePageOnFilter=function(){var e=a.state.currentPage;e>a.maxPage()&&a.setState({currentPage:a.maxPage()}),e<1&&a.setState({currentPage:1})},a.maxPage=function(){return Math.ceil(a.renderSubsList().length/K)},a.handleSubmit=function(e){var t=a.props,n=t.isAuth,s=t.addSub,u=t.subs,o=t.ownerId;n&&(u.find(function(t){return t.name.toLowerCase().trim()===e.name.toLocaleLowerCase().trim()||t.userID===e.userID.trim()})?O():s(Object(r.a)({favorite:!1,date:"".concat((new Date).toLocaleDateString()," ").concat((new Date).toLocaleTimeString())},e,{ownerId:o})).then(function(e){e&&S(u.length+1)}))},a.handleFilterSubs=function(e){return a.setState({query:e.target.value})},a.filterFavorites=function(){return a.props.subs.filter(function(e){return e.favorite})},a.showFavorites=function(){return a.setState(function(e){return{showFavorites:!e.showFavorites,onChangeText:e.showFavorites?"Show favourites":"Show all"}})},a.filteredSubs=function(e,t){return ee(e,t)},a.showTotalAmmountOfSubs=function(){var e=a.props.subs,t=a.state,n=t.showFavorites,r=t.query;return n?a.filteredSubs(a.filterFavorites(),r).length:a.filteredSubs(e,r).length},a.renderSubsList=function(){var e=a.props.subs,t=a.state,n=t.showFavorites,r=t.query;return n?a.filteredSubs(a.filterFavorites(),r):a.filteredSubs(e,r)},a.handleChangePage=function(e){a.setState(function(t){return{currentPage:"next"===e?t.currentPage+1:t.currentPage-1}})},a.renderPaginationList=function(){var e=a.state,t=e.currentPage,r=e.perPage,s=t*r,u=s-r;return Object(n.a)(a.renderSubsList().reverse()).slice(u,s)},a}return Object(i.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isAuth,a=e.getSubs,n=e.ownerId;t&&a(n)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.isAuth,r=a.getSubs,s=a.ownerId,u=this.state.query;e.isAuth!==n&&n&&r(s),t.query!==u&&this.handleChangePageOnFilter()}},{key:"render",value:function(){var e=this.state,t=e.query,a=e.onChangeText,n=e.currentPage,r=this.props.subsLoad;return b.a.createElement("div",null,r&&b.a.createElement("div",{className:"rainbow-marker-loader"}),b.a.createElement(j,{handleSubmit:this.handleSubmit,query:t,handleFilterSubs:this.handleFilterSubs,showFavorites:this.showFavorites,onChangeText:a}),b.a.createElement("div",{className:"subs-length-wrap"},b.a.createElement("p",{className:"subs-length-text"},"Total length: ",this.showTotalAmmountOfSubs())),b.a.createElement(z,{subscribers:this.renderPaginationList()}),this.renderSubsList().length>20&&b.a.createElement($,{currentPage:n,maxPage:this.maxPage,handleChangePage:this.handleChangePage}),b.a.createElement(d.a,null))}}]),t}(l.Component),ae={getSubs:function(e){return function(){var t=Object(k.a)(P.a.mark(function t(a,n){var r,s;return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(Y.e)(n())){t.next=3;break}return t.abrupt("return");case 3:return Object(I.a)(r),a(Object(A.f)()),t.prev=5,t.next=8,H(e);case 8:s=t.sent,a(Object(A.g)(s)),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(5),console.error("error while getting subs: ".concat(t.t0)),a(Object(A.e)(t.t0));case 16:case"end":return t.stop()}},t,null,[[5,12]])}));return function(e,a){return t.apply(this,arguments)}}()},addSub:function(e){return function(){var t=Object(k.a)(P.a.mark(function t(a,n){var r,s;return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(Y.e)(n())){t.next=3;break}return t.abrupt("return");case 3:return Object(I.a)(r),a(Object(A.c)()),t.prev=5,t.next=8,B(e);case 8:return s=t.sent,t.abrupt("return",a(Object(A.d)(s)));case 12:t.prev=12,t.t0=t.catch(5),console.error("error while adding sub: ".concat(t.t0)),a(Object(A.b)(t.t0));case 16:case"end":return t.stop()}},t,null,[[5,12]])}));return function(e,a){return t.apply(this,arguments)}}()}};t.default=Object(p.b)(function(e){return{isAuth:Object(Y.c)(e),subs:g(e),subsLoad:v(e),addSubLoad:w(e),ownerId:Object(Y.d)(e)}},ae)(te)}}]);
//# sourceMappingURL=11.9c60b32f.chunk.js.map