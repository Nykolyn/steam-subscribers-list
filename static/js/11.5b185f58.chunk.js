(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{94:function(e,t,a){"use strict";a.r(t);var n=a(50),r=a(16),s=a(24),u=a(104),o=a(36),c=a(32),i=a(35),l=a(0),d=a.n(l),b=a(17),m=a(139),p=(a(138),a(33)),h=function(e){var t=e.text,a=e.onClick,n=e.type,r=e.loading;return d.a.createElement("button",{type:n,className:"jelly-button",onClick:a},r?d.a.createElement("p",{className:"super-slide"},"Loading..."):d.a.createElement("p",{className:"super-slide"},t))};h.defaultProps={onClick:null,loading:!1};var f=h,g=function(e){return e.subscribtions.subs},v=function(e){return e.subscribtions.loading.getSubs},w=function(e){return e.subscribtions.loading.addSub},O=function(e){return e.subscribtions.date.sameDayAdded},S=function(e){return e.subscribtions.date.sameWeekAdded},j=function(e){return e.subscribtions.date.sameMonthAdded},C=function(e){return e.subscribtions.date.lastYearAdded},E=function(){return m.b.error("\ud83e\udd2a Sub already exists",{position:"top-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},x=function(e){return m.b.success("\ud83e\udd1f Sub added! Total ammout:  ".concat(e),{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},y=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",userID:""},a.warn=function(){return m.b.warn("\ud83d\ude24\ud83d\ude24\ud83d\ude24 Fill the field!!!",{position:"top-left",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;return a.setState(Object(p.a)({},n,r))},a.handleFormSubmit=function(e){e.preventDefault();var t=a.state,n=t.name,r=t.userID;return""===n?a.warn():r.includes("/")?a.warn():(a.props.handleSubmit(a.state),a.setState({name:"",userID:""}))},a}return Object(i.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.userID,n=this.props,r=n.handleFilterSubs,s=n.query,u=n.showFavorites,o=n.onChangeText,c=n.loading;return d.a.createElement("form",{onSubmit:this.handleFormSubmit,className:"sub-form"},d.a.createElement("input",{type:"text",autoComplete:"off",value:t,name:"name",onChange:this.handleInputChange,className:"sub-form__input",placeholder:"Add sub here"}),d.a.createElement("input",{type:"text",autoComplete:"off",value:a,name:"userID",onChange:this.handleInputChange,className:"sub-form__input",placeholder:"User id (optional)"}),d.a.createElement(f,{text:"Add new sub",loading:c,type:"submit"}),d.a.createElement("input",{type:"text",autoComplete:"off",value:s,autoFocus:!0,placeholder:"filter sub here",name:"query",onChange:r,className:"sub-form__input"}),d.a.createElement(f,{text:o,type:"button",onClick:function(){return u()}}),d.a.createElement(m.a,{position:"top-right",autoClose:4e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnVisibilityChange:!0,draggable:!0,pauseOnHover:!0}))}}]),t}(l.Component),k=Object(b.b)(function(e){return{loading:w(e)}})(y),P=a(3),A=a.n(P),F=a(11),N=a(34),D=a(164),L=a(48),I=a(5),T=a(18),_=a.n(T),q="https://steam-subscribtions.herokuapp.com",M=function(e){return _.a.get("".concat(q,"/subscribers/").concat(e)).then(function(e){return e.data.subs})},B=function(e){return _.a.post("".concat(q,"/subscribers"),e).then(function(e){return e.data.addedSub})},H=function(e,t){return _.a.patch("".concat(q,"/subscribers/updateSub/").concat(e),t).then(function(e){return e.data.updatedSub})},Y=a(30),W=a(21),J=function(e){var t=e._id,a=e.name,n=e.date,r=e.favorite,s=e.updateFavSub,u=Object(l.useState)(!1),o=Object(N.a)(u,2),c=o[0],i=o[1],b=function(){var e=Object(F.a)(A.a.mark(function e(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,s(t,{favorite:!r});case 3:setTimeout(Object(F.a)(A.a.mark(function e(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i(!1);case 1:case"end":return e.stop()}},e)})),1e3);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",null,d.a.createElement("h2",null,a),d.a.createElement("p",{className:"item-date"},"Added: ","".concat(Object(W.e)(n),", ").concat(n))),d.a.createElement("button",{className:"image-wrapper",type:"button",onClick:function(){return b()}},c?d.a.createElement(D.ClipLoader,{color:"#fff",loading:c}):d.a.createElement("img",{className:"item-image",src:r?"https://image.flaticon.com/icons/svg/148/148838.svg":"https://image.flaticon.com/icons/svg/149/149219.svg",alt:"fav"})))};J.defaultProps={favorite:!1};var U={updateFavSub:function(e,t){return function(){var a=Object(F.a)(A.a.mark(function a(n,r){var s,u;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=Object(Y.e)(r())){a.next=3;break}return a.abrupt("return");case 3:return Object(L.a)(s),n(Object(I.i)()),a.prev=5,a.next=8,H(e,t);case 8:return u=a.sent,a.next=11,n(Object(I.j)(u));case 11:return a.abrupt("return",a.sent);case 14:a.prev=14,a.t0=a.catch(5),n(Object(I.h)(a.t0)),console.error("error while updating favorite sub: ".concat(a.t0));case 18:case"end":return a.stop()}},a,null,[[5,14]])}));return function(e,t){return a.apply(this,arguments)}}()}},V=Object(b.b)(null,U)(J),z=Object(b.b)(function(e){return{loading:w(e)}})(function(e){var t=e.subscribers,a=e.loading;return d.a.createElement("ul",{className:"subs-list container"},a&&d.a.createElement("li",{className:"subs-list__item"},d.a.createElement("div",{className:"rainbow-marker-loader"})),t.map(function(e){return d.a.createElement("li",{key:e.userID,className:"subs-list__item"},d.a.createElement(V,e))}))}),G=1,K=20,Q=a(221),R=a(189),X=a.n(R),Z=a(190),$=a.n(Z),ee=function(e){var t=e.maxPage,a=e.handleChangePage,n=e.currentPage;return d.a.createElement("div",{className:"pagination-wrapper"},d.a.createElement(Q.a,{className:"pagination-button",color:"primary",name:"prev",disabled:n===G,onClick:function(){return a("prev")}},d.a.createElement(X.a,{className:"pagination-button",disabled:n===G})),d.a.createElement("h1",null,"Page ",n," of ",t()),d.a.createElement(Q.a,{className:"pagination-button",name:"next",disabled:n===t(),onClick:function(){return a("next")}},d.a.createElement($.a,{className:"pagination-button",disabled:n===G})))};function te(e){var t=e.showTotalAmmountOfSubs,a=e.sameDayAdded,n=e.sameWeekAdded,r=e.sameMonthAdded,s=e.lastYearAdded;return d.a.createElement("div",{className:"subs-length-wrap"},d.a.createElement("p",{className:"subs-length-text"},"Total length: ",t),d.a.createElement("p",{className:"subs-length-text"},"Today added: ",a),d.a.createElement("p",{className:"subs-length-text"},"Added this week: ",n),d.a.createElement("p",{className:"subs-length-text"},"Added this month: ",r),s&&d.a.createElement("p",{className:"subs-length-text"},"Added last year: ",s))}te.defaultProps={lastYearAdded:0};var ae=Object(b.b)(function(e){return{sameDayAdded:O(e),sameWeekAdded:S(e),sameMonthAdded:j(e),lastYearAdded:C(e)}})(te),ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.filter(function(e){return e.name.toLowerCase().includes(t.toLowerCase())||e.userID===t})},re=function(e){function t(){var e,a;Object(s.a)(this,t);for(var u=arguments.length,i=new Array(u),l=0;l<u;l++)i[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={query:"",showFavorites:!1,onChangeText:"Show favourites",perPage:K,currentPage:G},a.handleChangePageOnFilter=function(){var e=a.state.currentPage;e>a.maxPage()&&a.setState({currentPage:a.maxPage()}),e<1&&a.setState({currentPage:1})},a.maxPage=function(){return Math.ceil(a.renderSubsList().length/K)},a.handleSubmit=function(e){var t=a.props,n=t.isAuth,s=t.addSub,u=t.subs,o=t.ownerId;n&&(u.find(function(t){return t.name.toLowerCase().trim()===e.name.toLocaleLowerCase().trim()||t.userID===e.userID.trim()})?E():s(Object(r.a)({favorite:!1,date:"".concat((new Date).toLocaleDateString()," ").concat((new Date).toLocaleTimeString())},e,{ownerId:o})).then(function(e){e&&x(u.length+1)}))},a.handleFilterSubs=function(e){return a.setState({query:e.target.value})},a.filterFavorites=function(){return a.props.subs.filter(function(e){return e.favorite})},a.showFavorites=function(){return a.setState(function(e){return{showFavorites:!e.showFavorites,onChangeText:e.showFavorites?"Show favourites":"Show all"}})},a.filteredSubs=function(e,t){return ne(e,t)},a.showTotalAmmountOfSubs=function(){var e=a.props.subs,t=a.state,n=t.showFavorites,r=t.query;return n?a.filteredSubs(a.filterFavorites(),r).length:a.filteredSubs(e,r).length},a.renderSubsList=function(){var e=a.props.subs,t=a.state,n=t.showFavorites,r=t.query;return n?a.filteredSubs(a.filterFavorites(),r):a.filteredSubs(e,r)},a.handleChangePage=function(e){a.setState(function(t){return{currentPage:"next"===e?t.currentPage+1:t.currentPage-1}})},a.renderPaginationList=function(){var e=a.state,t=e.currentPage,r=e.perPage,s=t*r,u=s-r;return Object(n.a)(a.renderSubsList().reverse()).slice(u,s)},a}return Object(i.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isAuth,a=e.getSubs,n=e.ownerId;t&&a(n)}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.query,n=this.props.subs;e.subs!==n&&a&&console.log("works"),t.query!==a&&this.handleChangePageOnFilter()}},{key:"render",value:function(){var e=this.state,t=e.query,a=e.onChangeText,n=e.currentPage,r=this.props.subsLoad;return d.a.createElement("div",null,r&&d.a.createElement("div",{className:"rainbow-marker-loader"}),d.a.createElement(k,{handleSubmit:this.handleSubmit,query:t,handleFilterSubs:this.handleFilterSubs,showFavorites:this.showFavorites,onChangeText:a}),d.a.createElement(ae,{showTotalAmmountOfSubs:this.showTotalAmmountOfSubs()}),d.a.createElement(z,{subscribers:this.renderPaginationList()}),this.renderSubsList().length>20&&d.a.createElement(ee,{currentPage:n,maxPage:this.maxPage,handleChangePage:this.handleChangePage}),d.a.createElement(m.a,null))}}]),t}(l.Component),se={getSubs:function(e){return function(){var t=Object(F.a)(A.a.mark(function t(a,n){var r,s;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(Y.e)(n())){t.next=3;break}return t.abrupt("return");case 3:return Object(L.a)(r),a(Object(I.f)()),t.prev=5,t.next=8,M(e);case 8:s=t.sent,a(Object(I.g)(s)),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(5),console.error("error while getting subs: ".concat(t.t0)),a(Object(I.e)(t.t0));case 16:case"end":return t.stop()}},t,null,[[5,12]])}));return function(e,a){return t.apply(this,arguments)}}()},addSub:function(e){return function(){var t=Object(F.a)(A.a.mark(function t(a,n){var r,s;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(Y.e)(n())){t.next=3;break}return t.abrupt("return");case 3:return Object(L.a)(r),a(Object(I.c)()),t.prev=5,t.next=8,B(e);case 8:return s=t.sent,t.abrupt("return",a(Object(I.d)(s)));case 12:t.prev=12,t.t0=t.catch(5),console.error("error while adding sub: ".concat(t.t0)),a(Object(I.b)(t.t0));case 16:case"end":return t.stop()}},t,null,[[5,12]])}));return function(e,a){return t.apply(this,arguments)}}()}};t.default=Object(b.b)(function(e){return{isAuth:Object(Y.c)(e),subs:g(e),subsLoad:v(e),addSubLoad:w(e),ownerId:Object(Y.d)(e)}},se)(re)}}]);
//# sourceMappingURL=11.5b185f58.chunk.js.map