(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{91:function(e,t,a){"use strict";a.r(t);var n=a(48),r=a(15),s=a(22),u=a(101),o=a(34),c=a(30),i=a(33),l=a(0),b=a.n(l),d=a(16),m=a(136),p=(a(135),a(31)),f=function(e){var t=e.text,a=e.onClick,n=e.type,r=e.loading;return b.a.createElement("button",{type:n,className:"jelly-button",onClick:a},r?b.a.createElement("p",{className:"super-slide"},"Loading..."):b.a.createElement("p",{className:"super-slide"},t))};f.defaultProps={onClick:null,loading:!1};var h=f,g=function(e){return e.subscribtions.subs},v=function(e){return e.subscribtions.loading.getSubs},w=function(e){return e.subscribtions.loading.addSub},O=function(){return m.b.error("\ud83e\udd2a Sub already exists",{position:"top-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},S=function(e){return m.b.success("\ud83e\udd1f Sub added! Total ammout:  ".concat(e),{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},j=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",userID:""},a.warn=function(){return m.b.warn("\ud83d\ude24\ud83d\ude24\ud83d\ude24 Fill the field!!!",{position:"top-left",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;return a.setState(Object(p.a)({},n,r))},a.handleFormSubmit=function(e){e.preventDefault();var t=a.state,n=t.name,r=t.userID;return""===n?a.warn():r.includes("/")?a.warn():(a.props.handleSubmit(a.state),a.setState({name:"",userID:""}))},a}return Object(i.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.userID,n=this.props,r=n.handleFilterSubs,s=n.query,u=n.showFavorites,o=n.onChangeText,c=n.loading;return b.a.createElement("form",{onSubmit:this.handleFormSubmit,className:"sub-form"},b.a.createElement("input",{type:"text",autoComplete:"off",value:t,name:"name",onChange:this.handleInputChange,className:"sub-form__input",placeholder:"Add sub here"}),b.a.createElement("input",{type:"text",autoComplete:"off",value:a,name:"userID",onChange:this.handleInputChange,className:"sub-form__input",placeholder:"User id (optional)"}),b.a.createElement(h,{text:"Add new sub",loading:c,type:"submit"}),b.a.createElement("input",{type:"text",autoComplete:"off",value:s,autoFocus:!0,placeholder:"filter sub here",name:"query",onChange:r,className:"sub-form__input"}),b.a.createElement(h,{text:o,type:"button",onClick:function(){return u()}}),b.a.createElement(m.a,{position:"top-right",autoClose:4e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnVisibilityChange:!0,draggable:!0,pauseOnHover:!0}))}}]),t}(l.Component),C=Object(d.b)(function(e){return{loading:w(e)}})(j),x=a(3),E=a.n(x),y=a(10),P=a(32),k=a(161),F=a.n(k),N=a(163),L=a(46),D=a(6),I=a(17),T=a.n(I),_="https://steam-subscribtions.herokuapp.com",q=function(e){return T.a.get("".concat(_,"/subscribers/").concat(e)).then(function(e){return e.data.subs})},A=function(e){return T.a.post("".concat(_,"/subscribers"),e).then(function(e){return e.data.addedSub})},H=function(e,t){return T.a.patch("".concat(_,"/subscribers/updateSub/").concat(e),t).then(function(e){return e.data.updatedSub})},B=a(28);F.a.defaultFormat="DD.MM.YYYY HH:mm";var M=function(e){var t=e._id,a=e.name,n=e.date,r=e.favorite,s=e.updateFavSub,u=Object(l.useState)(!1),o=Object(P.a)(u,2),c=o[0],i=o[1],d=function(){var e=Object(y.a)(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,s(t,{favorite:!r});case 3:setTimeout(Object(y.a)(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i(!1);case 1:case"end":return e.stop()}},e)})),1e3);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),m=F()(n,F.a.defaultFormat).fromNow();return b.a.createElement(b.a.Fragment,null,b.a.createElement("div",null,b.a.createElement("h2",null,a),b.a.createElement("p",{className:"item-date"},"Added: ","".concat(m,", ").concat(n))),b.a.createElement("button",{className:"image-wrapper",type:"button",onClick:function(){return d()}},c?b.a.createElement(N.ClipLoader,{color:"#fff",loading:c}):b.a.createElement("img",{className:"item-image",src:r?"https://image.flaticon.com/icons/svg/148/148838.svg":"https://image.flaticon.com/icons/svg/149/149219.svg",alt:"fav"})))};M.defaultProps={favorite:!1};var Y={updateFavSub:function(e,t){return function(){var a=Object(y.a)(E.a.mark(function a(n,r){var s,u;return E.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=Object(B.e)(r())){a.next=3;break}return a.abrupt("return");case 3:return Object(L.a)(s),n(Object(D.i)()),a.prev=5,a.next=8,H(e,t);case 8:return u=a.sent,a.next=11,n(Object(D.j)(u));case 11:return a.abrupt("return",a.sent);case 14:a.prev=14,a.t0=a.catch(5),n(Object(D.h)(a.t0)),console.error("error while updating favorite sub: ".concat(a.t0));case 18:case"end":return a.stop()}},a,null,[[5,14]])}));return function(e,t){return a.apply(this,arguments)}}()}},J=Object(d.b)(null,Y)(M),U=Object(d.b)(function(e){return{loading:w(e)}})(function(e){var t=e.subscribers,a=e.loading;return b.a.createElement("ul",{className:"subs-list container"},a&&b.a.createElement("li",{className:"subs-list__item"},b.a.createElement("div",{className:"rainbow-marker-loader"})),t.map(function(e){return b.a.createElement("li",{className:"subs-list__item"},b.a.createElement(J,e))}))}),V=1,z=20,G=a(220),K=a(188),Q=a.n(K),R=a(189),W=a.n(R),X=function(e){var t=e.maxPage,a=e.handleChangePage,n=e.currentPage;return b.a.createElement("div",{className:"pagination-wrapper"},b.a.createElement(G.a,{className:"pagination-button",color:"primary",name:"prev",disabled:n===V,onClick:function(){return a("prev")}},b.a.createElement(Q.a,{className:"pagination-button",disabled:n===V})),b.a.createElement("h1",null,"Page ",n," of ",t()),b.a.createElement(G.a,{className:"pagination-button",name:"next",disabled:n===t(),onClick:function(){return a("next")}},b.a.createElement(W.a,{className:"pagination-button",disabled:n===V})))},Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.filter(function(e){return e.name.toLowerCase().includes(t.toLowerCase())||e.userID===t})},$=function(e){function t(){var e,a;Object(s.a)(this,t);for(var u=arguments.length,i=new Array(u),l=0;l<u;l++)i[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={query:"",showFavorites:!1,onChangeText:"Show favourites",perPage:z,currentPage:V},a.handleChangePageOnFilter=function(){var e=a.state.currentPage;e>a.maxPage()&&a.setState({currentPage:a.maxPage()}),e<1&&a.setState({currentPage:1})},a.maxPage=function(){return Math.ceil(a.renderSubsList().length/z)},a.handleSubmit=function(e){var t=a.props,n=t.isAuth,s=t.addSub,u=t.subs,o=t.ownerId;n&&(u.find(function(t){return t.name.toLowerCase().trim()===e.name.toLocaleLowerCase().trim()||t.userID===e.userID.trim()})?O():s(Object(r.a)({favorite:!1,date:"".concat((new Date).toLocaleDateString()," ").concat((new Date).toLocaleTimeString())},e,{ownerId:o})).then(function(e){e&&S(u.length+1)}))},a.handleFilterSubs=function(e){return a.setState({query:e.target.value})},a.filterFavorites=function(){return a.props.subs.filter(function(e){return e.favorite})},a.showFavorites=function(){return a.setState(function(e){return{showFavorites:!e.showFavorites,onChangeText:e.showFavorites?"Show favourites":"Show all"}})},a.filteredSubs=function(e,t){return Z(e,t)},a.showTotalAmmountOfSubs=function(){var e=a.props.subs,t=a.state,n=t.showFavorites,r=t.query;return n?a.filteredSubs(a.filterFavorites(),r).length:a.filteredSubs(e,r).length},a.renderSubsList=function(){var e=a.props.subs,t=a.state,n=t.showFavorites,r=t.query;return n?a.filteredSubs(a.filterFavorites(),r):a.filteredSubs(e,r)},a.handleChangePage=function(e){a.setState(function(t){return{currentPage:"next"===e?t.currentPage+1:t.currentPage-1}})},a.renderPaginationList=function(){var e=a.state,t=e.currentPage,r=e.perPage,s=t*r,u=s-r;return Object(n.a)(a.renderSubsList().reverse()).slice(u,s)},a}return Object(i.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isAuth,a=e.getSubs,n=e.ownerId;t&&a(n)}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.query;t.query!==a&&this.handleChangePageOnFilter()}},{key:"render",value:function(){var e=this.state,t=e.query,a=e.onChangeText,n=e.currentPage,r=this.props.subsLoad;return b.a.createElement("div",null,r&&b.a.createElement("div",{className:"rainbow-marker-loader"}),b.a.createElement(C,{handleSubmit:this.handleSubmit,query:t,handleFilterSubs:this.handleFilterSubs,showFavorites:this.showFavorites,onChangeText:a}),b.a.createElement("div",{className:"subs-length-wrap"},b.a.createElement("p",{className:"subs-length-text"},"Total length: ",this.showTotalAmmountOfSubs())),b.a.createElement(U,{subscribers:this.renderPaginationList()}),this.renderSubsList().length>20&&b.a.createElement(X,{currentPage:n,maxPage:this.maxPage,handleChangePage:this.handleChangePage}),b.a.createElement(m.a,null))}}]),t}(l.Component),ee={getSubs:function(e){return function(){var t=Object(y.a)(E.a.mark(function t(a,n){var r,s;return E.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(B.e)(n())){t.next=3;break}return t.abrupt("return");case 3:return Object(L.a)(r),a(Object(D.f)()),t.prev=5,t.next=8,q(e);case 8:s=t.sent,a(Object(D.g)(s)),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(5),console.error("error while getting subs: ".concat(t.t0)),a(Object(D.e)(t.t0));case 16:case"end":return t.stop()}},t,null,[[5,12]])}));return function(e,a){return t.apply(this,arguments)}}()},addSub:function(e){return function(){var t=Object(y.a)(E.a.mark(function t(a,n){var r,s;return E.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(B.e)(n())){t.next=3;break}return t.abrupt("return");case 3:return Object(L.a)(r),a(Object(D.c)()),t.prev=5,t.next=8,A(e);case 8:return s=t.sent,t.abrupt("return",a(Object(D.d)(s)));case 12:t.prev=12,t.t0=t.catch(5),console.error("error while adding sub: ".concat(t.t0)),a(Object(D.b)(t.t0));case 16:case"end":return t.stop()}},t,null,[[5,12]])}));return function(e,a){return t.apply(this,arguments)}}()}};t.default=Object(d.b)(function(e){return{isAuth:Object(B.c)(e),subs:g(e),subsLoad:v(e),addSubLoad:w(e),ownerId:Object(B.d)(e)}},ee)($)}}]);
//# sourceMappingURL=11.509d8561.chunk.js.map